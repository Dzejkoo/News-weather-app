(()=>{"use strict";class e{constructor(){this.apiKey="cc12c5b435d66d200bd213f429d2c571",this.apiKeyForecast="eb8b64ff4d674b8cad7b5ac954bd6e6e",this.url="https://api.openweathermap.org/data/2.5/",this.urlForecast="https://api.weatherbit.io/v2.0/",this.localizationCity=document.querySelector(".weather-today__localization-city"),this.localizationCountry=document.querySelector(".weather-today__localization-country"),this.temperature=document.querySelector(".weather-temperature__number-celsjusz"),this.sunCycleTime=document.querySelectorAll(".weather-today__cycle-time"),this.date=document.querySelector(".weather-today__date-name"),this.tempIcon=document.querySelector(".weather-temperature__icon"),this.humidity=document.querySelector(".weather-temperature__property-humidity--bold"),this.wind=document.querySelector(".weather-temperature__property-wind--bold"),this.pressure=document.querySelector(".weather-temperature__property-pressure--bold"),this.daysName=document.querySelectorAll(".weather-week__tittle"),this.daysIcon=document.querySelectorAll(".weather-week__icon"),this.daysHighTemp=document.querySelectorAll(".weather-week__higher"),this.daysLowTemp=document.querySelectorAll(".weather-week__lower"),this.inputMap=document.querySelector(".weather-map__input"),this.setParametersForTodayTemperature()}setParametersForTodayTemperature(e){let t=void 0===e?52.409538:e.lat,r=void 0===e?16.931992:e.lng;fetch(`${this.url}weather?lat=${t}&lon=${r}&units=metric&appid=${this.apiKey}`).then((e=>e.json())).then((e=>{const{name:t,main:{temp:r,humidity:i,pressure:s},wind:{speed:a},sys:{country:o,sunset:n,sunrise:c}}=e;this.setCityAndCountry(t,o),this.setTemperature(r),this.setCycleSun([c,n]),this.setIcon(`https://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png`),this.setProperties(i,a,s)})),this.setParametersForecast(t,r)}setCityAndCountry(e,t){this.localizationCity.innerHTML=`${e}, `,this.localizationCountry.innerHTML=`${t}`}setParametersForecast(e,t){fetch(`${this.urlForecast}forecast/daily?lat=${e}&lon=${t}&key=${this.apiKeyForecast}&days=6`).then((e=>e.json())).then((e=>this.setDateByApi(e.data)))}setDateByApi(e){const t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=e.splice(1,5);for(let e=0;e<this.daysName.length;e++){let i=new Date(r[e].valid_date),s=`https://www.weatherbit.io/static/img/icons/${r[e].weather.icon}.png`;this.daysName[e].textContent=t[i.getDay()],this.daysIcon[e].setAttribute("src",s),this.daysHighTemp[e].textContent=`${r[e].max_temp.toFixed(0)}°`,this.daysLowTemp[e].textContent=`${r[e].min_temp.toFixed(0)}°`}this.setCurrentTime()}setTemperature(e){this.temperature.innerHTML=e.toFixed(0)}setCycleSun(e){for(let t=0;t<e.length;t++){let r=new Date(1e3*e[t]).toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"});this.sunCycleTime[t].textContent=r}}setCurrentTime(){let e=new Date;this.date.textContent=`Today ${e.getDate()} ${["January","Febuary","March","Aprlil","May","June","July","August","September","October","November","December"][e.getMonth()]} `}setIcon(e){this.tempIcon.setAttribute("src",e)}setProperties(e,t,r){this.humidity.textContent=`${e} %`,this.wind.textContent=`${t} km/h`,this.pressure.textContent=`${r} hPa`}}class t{constructor(){this.apiKey="cc12c5b435d66d200bd213f429d2c571",this.iconLocalization=document.querySelector(".weather-today__localization-icon"),this.weatherMap=document.querySelector(".weather-map"),this.inputMap=document.querySelector(".weather-map__input"),this.setLocalizationByMap(),this.createMap()}setLocalizationByMap(){this.iconLocalization.addEventListener("click",(()=>{this.weatherMap.classList.toggle("weather-map--active")}))}createMap(){let t=L.map("map").setView([50.22977,21.01178],6);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),t.on("click",(function(t){(new e).setParametersForTodayTemperature(t.latlng),document.querySelector(".weather-map").classList.remove("weather-map--active")}))}}class r{constructor(){this.apiKey="cafd73a1a4bb442999ce4c3167c3344e",this.articleImg=document.querySelectorAll(".news-article__image"),this.fromWhereArticle=document.querySelectorAll(".news-article__from-where"),this.titleArticle=document.querySelectorAll(".news-article__text-title"),this.expansionArticle=document.querySelectorAll(".news-article__text-expansion"),this.goToWebSiteNews=document.querySelectorAll(".news-article__read-more"),this.artciles=[{img:document.querySelector(".news-article__image"),fromWhere:document.querySelector(".news-article__from-where"),title:document.querySelector(".news-article__text-title"),expansion:document.querySelector(".news-article__text-expansion"),websiteNews:document.querySelector(".news-article__read-more")}]}getDataFromApiByCategory(e){fetch(`https://newsapi.org/v2/top-headlines?country=pl&category=${e}&apiKey=${this.apiKey}`).then((e=>e.json())).then((e=>{this.setPropertyForNews(e.articles)}))}setPropertyForNews(e){for(let t=0;t<this.articleImg.length;t++)this.titleArticle[t].textContent=`${e[t].title.substring(0,40)} ...`,this.fromWhereArticle[t].textContent=`${e[t].source.name}`,this.goToWebSiteNews[t].setAttribute("href",e[t].url),"string"==typeof e[t].description?this.expansionArticle[t].textContent=`${e[t].description.substring(0,80)} ...`:this.expansionArticle[t].textContent="Przejdź na strone artykułu, żeby dowiedzieć się więcej!",this.articleImg[t].setAttribute("src",""),"string"==typeof e[t].urlToImage?this.articleImg[t].setAttribute("src",e[t].urlToImage):this.articleImg[t].setAttribute("src","./src/images/no-image.jpg")}}class i{constructor(){this.newsApiCategoryItems=document.querySelectorAll(".nav-news__item"),this.news=new r,this.chooseCategory(),this.news.getDataFromApiByCategory("general")}chooseCategory(){for(let e=0;e<this.newsApiCategoryItems.length;e++)this.newsApiCategoryItems[e].addEventListener("click",(()=>{const t=this.newsApiCategoryItems[e].dataset.option;this.newsApiCategoryItems.forEach((e=>e.classList.remove("nav-news__item--active"))),this.newsApiCategoryItems[e].classList.add("nav-news__item--active"),this.news.getDataFromApiByCategory(t)}))}}document.addEventListener("DOMContentLoaded",(()=>{const r=new e;new i,new t(r.setParametersForTodayTemperature)}))})();